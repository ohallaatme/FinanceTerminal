#:import rgba kivy.utils.get_color_from_hex
#:import utils kivy.utils

## Main Menu Screen
<MenuScreen>:

    name: "MenuScreen"

    GridLayout:
        cols: 1
        Label:
            # Need to think of name, play on Bloomberg terminal/freedom of info?
            # play on occupy wall street?
            text: "Snowden Terminal"
            font_size: 30
            text_size: self.size
            halign: "center"
            valign: "middle"
            canvas.before:
                Color:  
                    # dark indigo
                    rgba: utils.get_color_from_hex("#23273c")
                Rectangle:
                    pos: self.pos
                    size: self.size
        
        GridLayout:
            cols: 2
            GridLayout:
                cols: 1
                padding: [10, 10, 5, 5]
                Button:
                    text: "Financial Statement Analysis"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    # light turquoise
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_fin_stmt_analysis()


            GridLayout:
                cols: 1
                padding: [5, 10, 10, 5]
                Button:
                    text: "Company Overview & Annual Report Text Analysis"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_co_overview()

            GridLayout:
                cols: 1
                padding: [10, 5, 5, 10]
                Button:
                    text: "Time Series Analysis"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_ts_analysis()

            GridLayout:
                cols: 1
                padding: [5, 5, 10, 10]
                Button:
                    text: "Educational Info"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_edu_info()

## --- Sub Menu Screens ---
<FinStmtAnalysis>:
    GridLayout:
        cols: 1
        Label:
            text: "Financial Statement Analysis"
            font_size: 30
            text_size: self.size
            halign: "center"
            valign: "middle"
            canvas.before:
                Color:  
                    # dark indigo
                    rgba: utils.get_color_from_hex("#23273c")
                Rectangle:
                    pos: self.pos
                    size: self.size

        GridLayout:
            cols: 2
            GridLayout:
                cols: 1
                padding: [10, 10, 5, 5]
                Button:
                    text: "Select Companies"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_select_cos()
            
            GridLayout:
                cols: 1
                padding: [5, 10, 10, 5]
                Button:
                    text: "Income Statement Scorecard"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_is_scorecard()
                
            GridLayout:
                cols: 1
                padding: [10, 5, 5, 5]
                Button:
                    text: "Balance Sheet Scorecard"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_bs_scorecard()

            GridLayout:
                cols: 1
                padding: [5, 5, 10, 5]
                Button:
                    text: "Cash Flows Scorecard"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_cf_scorecard()

            GridLayout:
                cols: 1
                padding: [10, 5, 5, 10]
                Button:
                    text: "Sector Scorecard"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_sector_scorecard()

            GridLayout:
                cols: 1
                padding: [5, 5, 10, 10]
                Button:
                    text: "Return to Menu"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    # pinkish red
                    background_color: utils.get_color_from_hex("FF5460")
                    on_release: root.hit_return_menu()

<CoOverview>:
    # global variables
    name: "CoOverview"
    ticker: ticker

    BoxLayout:
        orientation: "horizontal"
        
        BoxLayout:
            orientation: "vertical"

            Label: 
                text: "Company Overview"
                font_size: 20
                text_size: self.size
                halign: "center"
                valign: "middle"
                canvas.before:
                    Color: 
                        rgba: utils.get_color_from_hex("#23273c")
                    Rectangle:
                        pos: self.pos
                        size: self.size

            Label:
                text: "Enter the ticker (symbol) of the company you would like to pull statistics for below (e.g. MSFT for Microsoft). [b]Click 'Set Ticker' to confirm.[/b]"
                font_size: 15
                text_size: self.size
                markup: True
                padding_x: 5
                halign: "left"
                valign: "middle"
                canvas.before:
                    Color: 
                        rgba: utils.get_color_from_hex("#23273c")
                    Rectangle:
                        pos: self.pos
                        size: self.size

            BoxLayout:
                orientation: "vertical"
                
                GridLayout:
                    cols: 1
                    padding: [2, 2, 2, 1]
                    TextInput:
                        id: ticker
                        multiline: False
                
                GridLayout:
                    cols: 1
                    padding: [2, 1, 2, 2]
                    Button:
                        text: "Set Ticker" 
                        color: 0, 0, 0, 1
                        font_size: 20
                        text_size: self.size
                        halign: "center"
                        valign: "middle"
                        background_normal: ''
                        background_color: utils.get_color_from_hex("#41dc65")
                        on_release: root.hit_set_ticker()
        GridLayout:
            cols: 1
            GridLayout:
                cols: 1
                padding: [2, 2, 2, 1]
                Button:
                    text: "View Key Stats"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_key_stats()
                
            GridLayout:
                cols: 1
                padding: [2, 1, 2, 1]
                Button:
                    text: "View Industry Comparison"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_industry_comparison()

            GridLayout:
                cols: 1
                padding: [2, 1, 2, 1]
                Button:
                    text: "View Proc 3"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_proc_3()

            GridLayout:
                cols: 1
                padding: [2, 1, 2, 1]
                Button:
                    text: "View Proc 4"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#33cccc")
                    on_release: root.hit_proc_4()

            GridLayout:
                cols: 1
                padding: [2, 1, 2, 2]
                Button:
                    text: "Return to Main Menu"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("FF5460")
                    on_release: root.hit_return_menu()

## --- Financial Statement Analysis SubScreens
<CompanySelection>:
    # object properties for selecting companies
    co_1: co_1
    co_2: co_2
    co_3: co_3
    co_4: co_4
    co_5: co_5
    co_6: co_6
    co_7: co_7
    co_8: co_8
    co_9: co_9
    co_10: co_10

    BoxLayout:
        orientation: "horizontal"
        size: root.width, root.height

        GridLayout:
            cols: 1
            Label:
                text: "Company Selection"
                font_size: 30
                text_size: self.size
                font: "Arial"
                halign: "center"
                valign: "middle"
                canvas.before:
                    Color:  
                        # dark indigo
                        rgba: utils.get_color_from_hex("#23273c")
                    Rectangle:
                        pos: self.pos
                        size: self.size

            Label:
                text: "Enter the ticker (e.g. enter 'MSFT' for Microsoft) for up to 10 companies to analyze comparative financial statements."
                font_size: 15
                text_size: self.size
                halign: "center"
                valign: "middle"
                canvas.before:
                    Color:  
                        # dark indigo
                        rgba: utils.get_color_from_hex("#23273c")
                    Rectangle:
                        pos: self.pos
                        size: self.size
            GridLayout:
                cols: 1
                padding: [10, 10, 10, 5]
                Button:
                    text: "Go Back"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    # pinkish red
                    background_color: utils.get_color_from_hex("FF5460")
                    on_release: root.hit_back()

            GridLayout:
                cols: 1
                padding: [10, 5, 10, 10]
                Button:
                    text: "Set Company Selection"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("#41dc65")
                    on_release: root.hit_save_symbols()

        GridLayout: 
            cols: 1
            BoxLayout:
                orientation: "vertical"
                GridLayout:
                    cols: 2
                    
                    GridLayout:
                        cols: 1
                        padding: [2, 2, 1, 1]
                        Label:
                            text: "Company 1: "
                            color: 0, 0, 0, 1
                            text_size: self.size
                            font_size: 15
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 2, 2, 1]
                        TextInput:
                            id: co_1
                            multiline: False
                            font_size: 15


                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 2: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_2
                            multiline: False
                            font_size: 15
                            
                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 3: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_3
                            multiline: False
                            font_size: 15

                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 4: "
                            color: 0, 0, 0, 1
                            text_size: self.size
                            font_size: 15
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_4
                            multiline: False
                            font_size: 15

                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 5: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_5
                            multiline: False
                            font_size: 15

                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 6: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_6
                            multiline: False
                            font_size: 15

                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 7: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_7
                            multiline: False
                            font_size: 15

                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 8: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_8
                            multiline: False
                            font_size: 15

                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 9: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_9
                            multiline: False
                            font_size: 15

                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Company 10: "
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#33cccc")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        TextInput:
                            id: co_10
                            multiline: False
                            font_size: 15
                    
                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Run Income Statement Scorecard?"
                            font_size: 15
                            color: 0, 0, 0, 1
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#c8c7cd")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                    
                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        CheckBox:
                            on_active: root.is_checkbox_click(self, self.active)
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#e1e0e6")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 1]
                        Label:
                            text: "Run Balance Sheet Scorecard?"
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#c8c7cd")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                    
                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 1]
                        CheckBox:
                            on_active: root.bs_checkbox_click(self, self.active)
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#e1e0e6")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                    GridLayout:
                        cols: 1
                        padding: [2, 1, 1, 2]
                        Label:
                            text: "Run Cash Flow Scorecard?"
                            color: 0, 0, 0, 1
                            font_size: 15
                            text_size: self.size
                            padding_x: 5
                            halign: "left"
                            valign: "middle"
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#c8c7cd")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size
                    
                    GridLayout:
                        cols: 1
                        padding: [1, 1, 2, 2]
                        CheckBox:
                            on_active: root.cf_checkbox_click(self, self.active)
                            canvas.before:
                                Color:
                                    rgba: utils.get_color_from_hex("#e1e0e6")
                                Rectangle:
                                    pos: self.pos
                                    size: self.size

## --- Company Overview Screens
<CoStats>:
    
    name: "CoStats"

    GridLayout:
        cols: 1
        Label:
            text: root.ticker
            font_size: 30
            text_size: self.size
            halign: "center"
            valign: "middle"
            canvas.before:
                Color:  
                    # dark indigo
                    rgba: utils.get_color_from_hex("#23273c")
                Rectangle:
                    pos: self.pos
                    size: self.size
        
        GridLayout:
            cols: 2
            GridLayout:
                cols: 1
                padding: [2, 2, 1, 1]
                Label:
                    text: "Sector"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            # 'Arrow' (white-ish grey)
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 2, 2, 1]
                Label:
                    text: root.sector
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: "Industry"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.industry
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: "Market Cap"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.market_cap
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: "EBITA"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.ebita
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: "Price-Earnings Ratio"
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.pe_ratio
                    color: 0, 0, 0, 1
                    font_size: 20
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size
            GridLayout:
                cols: 1
                padding: [2, 1, 1, 2]
                Button:
                    text: "Go Back"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("FF5460")
                    on_release: root.hit_back()

            GridLayout:
                cols: 1
                padding: [2, 1, 1, 2]
                Button:
                    text: "Return to Main Menu"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("FF5460")
                    on_release: root.hit_return_menu()

<IsScorecard>:

    name: "IsScorecard"

    # Parent GridLayout to make sure title and other pieces are not disproportionate
    GridLayout:
        cols: 1
        
        # Title
        GridLayout:
            cols: 1
            Label:
                text: "Income Statement Scorecard"
                font_size: 30
                text_size: self.size
                halign: "center"
                valign: "middle"
                canvas.before:
                    Color:
                        rgba: utils.get_color_from_hex("#23273c")
                    Rectangle:
                        pos: self.pos
                        size: self.size
                        
        # first try sectioning each KPI in its own GridLayout
        GridLayout:
            cols: 7
            
            ## Header rows
            GridLayout:
                cols: 1
                padding: [2, 2, 1, 1]
                Label:
                    markup: True
                    text: "[b]Company[/b]"
                    color: 0, 0, 0, 1
                    font_size: 15
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 2, 1, 1]
                Label:
                    markup: True
                    text: "[b]KPI[/b]"
                    color: 0, 0, 0, 1
                    font_size: 15
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 2, 1, 1]
                Label:
                    text: root.year_1
                    color: 0, 0, 0, 1
                    font_size: 15
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 2, 1, 1]
                Label:
                    text: root.year_2
                    color: 0, 0, 0, 1
                    font_size: 15
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 2, 1, 1]
                Label:
                    text: root.year_3
                    color: 0, 0, 0, 1
                    font_size: 15
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 2, 1, 1]
                Label:
                    text: root.year_4
                    color: 0, 0, 0, 1
                    font_size: 15
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 2, 2, 1]
                Label:
                    text: root.year_5
                    color: 0, 0, 0, 1
                    font_size: 15
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#c8c7cd")
                        Rectangle:
                            pos: self.pos
                            size: self.size
            # co 1 gp
            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: root.co_1
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            # slightly lighter grey
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: "Gross Profit %"
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#41dc65")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co1_y1
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co1_y2
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co1_y3
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size
            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co1_y4
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.gm_co1_y5
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            # co 2 gp
            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: root.co_2
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: "Gross Profit %"
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#41dc65")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co2_y1
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co2_y2
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co2_y3
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size
            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co2_y4
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.gm_co2_y5
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            # co 3 gp
            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: root.co_3
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: "Gross Profit %"
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#41dc65")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co3_y1
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co3_y2
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co3_y3
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size
            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co3_y4
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.gm_co3_y5
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            # co 4 gp
            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: root.co_4
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: "Gross Profit %"
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#41dc65")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co4_y1
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co4_y2
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co4_y3
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size
            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co4_y4
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.gm_co4_y5
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            # co 5 gp
            GridLayout:
                cols: 1
                padding: [2, 1, 1, 1]
                Label:
                    text: root.co_5
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: "Gross Profit %"
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#41dc65")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co5_y1
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co5_y2
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co5_y3
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size
            GridLayout:
                cols: 1
                padding: [1, 1, 1, 1]
                Label:
                    text: root.gm_co5_y4
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

            GridLayout:
                cols: 1
                padding: [1, 1, 2, 1]
                Label:
                    text: root.gm_co5_y5
                    color: 0, 0, 0, 1
                    font_size: 12
                    text_size: self.size
                    halign: "center"
                    valign: "middle"
                    canvas.before:
                        Color:  
                            rgba: utils.get_color_from_hex("#e1e0e6")
                        Rectangle:
                            pos: self.pos
                            size: self.size

        GridLayout:
            cols: 2

            GridLayout:
                cols: 1
                padding: [2, 2, 1, 2]
                Button:
                    text: "Go Back"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("FF5460")
                    on_release: root.hit_back()

            GridLayout:
                cols: 1
                padding: [1, 2, 2, 2]
                Button:
                    text: "Return to Main Menu"
                    color: 0, 0, 0, 1
                    text_size: self.size
                    font_size: 20
                    halign: "center"
                    valign: "middle"
                    background_normal: ''
                    background_color: utils.get_color_from_hex("FF5460")
                    on_release: root.hit_return_menu()